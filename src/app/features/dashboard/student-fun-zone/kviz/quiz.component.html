<div class="quiz-wrapper">
  <header class="quiz-header">
   <button class="btn-back" routerLink="/fun-zone">â† Nazad</button>
  
    <h1>ğŸ¯ HTML Kviz</h1>
    <div class="quiz-info">
      <span>{{ questions.length }} pitanja</span>
    </div>
  </header>

  <div class="quiz-container">

    <div class="questions-list" *ngIf="!quizSubmitted">
      <div 
        *ngFor="let question of questions; let i = index" 
        class="question-card"
      >
        <div class="question-header">
          <span class="question-number">{{ i + 1 }}.</span>
          <h3>{{ question.question }}</h3>
        </div>


        <div class="options-list" *ngIf="question.type === 'single'">
          <label 
            *ngFor="let option of question.options" 
            class="option-label radio"
            [class.selected]="isAnswerSelected(question.id, option.value)"
          >
            <input 
              type="radio" 
              [name]="'question-' + question.id"
              [value]="option.value"
              [checked]="isAnswerSelected(question.id, option.value)"
              (change)="selectSingleAnswer(question.id, option.value)"
            />
            <span class="option-text">{{ option.label }}</span>
          </label>
        </div>


        <div class="options-list" *ngIf="question.type === 'multiple'">
          <label 
            *ngFor="let option of question.options" 
            class="option-label checkbox"
            [class.selected]="isAnswerSelected(question.id, option.value)"
          >
            <input 
              type="checkbox" 
              [value]="option.value"
              [checked]="isAnswerSelected(question.id, option.value)"
              (change)="toggleMultipleAnswer(question.id, option.value)"
            />
            <span class="option-text">{{ option.label }}</span>
          </label>
        </div>

        <p class="question-hint" *ngIf="question.type === 'multiple'">
          <em>Odaberite taÄan odgovor(e) za svako pitanje. Neki mogu imati viÅ¡e taÄnih opcija!</em>
        </p>
      </div>
    </div>


    <div class="quiz-actions" *ngIf="!quizSubmitted">
      <button class="btn-submit" (click)="submitQuiz()">
        âœ… Provjerite odgovore
      </button>
    </div>


    <div class="quiz-results" *ngIf="quizSubmitted && result">
      <div class="result-card" [class.passed]="result.passed" [class.failed]="!result.passed">
        <div class="result-icon">
          {{ result.passed ? 'ğŸ‰' : 'ğŸ˜”' }}
        </div>
        <h2>{{ result.passed ? 'ÄŒestitamo!' : 'PokuÅ¡aj ponovo!' }}</h2>
        <div class="result-score">
          <span class="score">{{ result.score }}/{{ result.total }}</span>
          <span class="percentage">{{ result.percentage }}%</span>
        </div>
        <p class="result-message">
          {{ result.passed 
            ? 'OdliÄno znanje HTML-a! ProÅ¡li ste kviz.' 
            : 'Nastavite uÄiti! Potrebno je 60% ili viÅ¡e za prolaz.' }}
        </p>
      </div>


      <div class="answers-review">
        <h3>ğŸ“‹ Pregled odgovora</h3>
        <div 
          *ngFor="let question of questions; let i = index" 
          class="review-card"
          [class.correct]="isAnswerCorrect(question.id)"
          [class.incorrect]="!isAnswerCorrect(question.id)"
        >
          <div class="review-header">
            <span class="review-icon">
              {{ isAnswerCorrect(question.id) ? 'âœ…' : 'âŒ' }}
            </span>
            <h4>{{ i + 1 }}. {{ question.question }}</h4>
          </div>
          <div class="review-answer">
            <p><strong>Tvoj odgovor:</strong> 
              <span class="answer-text">
                {{ (userAnswers.get(question.id) || []).join(', ') || 'Nije odgovoreno' }}
              </span>
            </p>
            <p><strong>TaÄan odgovor:</strong> 
              <span class="correct-answer">
                {{ question.correctAnswers.join(', ') }}
              </span>
            </p>
          </div>
        </div>
      </div>

      <div class="quiz-actions">
        <button class="btn-reset" (click)="resetQuiz()">
          ğŸ”„ PokuÅ¡aj ponovo
        </button>
      </div>
    </div>
  </div>
</div>