<div class="tracker-wrapper">


  <header class="tracker-header">
    <button class="btn-back" (click)="goBack()">â† Nazad</button>
    <h1>ğŸ™ Gratitude Journal</h1>
    <button class="btn-add" (click)="showForm = !showForm">
      {{ showForm ? 'OtkaÅ¾i' : '+ Novi Zapis' }}
    </button>
  </header>


  <div class="tracker-content">


    <div class="stats-container">
      <div class="stat-card streak">
        <div class="stat-icon">ğŸ”¥</div>
        <div class="stat-info">
          <h3>{{ getCurrentStreak() }}</h3>
          <p>Trenutni niz</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">â­</div>
        <div class="stat-info">
          <h3>{{ getLongestStreak() }}</h3>
          <p>NajduÅ¾i niz</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">ğŸ“–</div>
        <div class="stat-info">
          <h3>{{ gratitudeEntries.length }}</h3>
          <p>Ukupno zapisa</p>
        </div>
      </div>
    </div>


    <div class="add-form" *ngIf="showForm">
      <form [formGroup]="gratitudeForm" (ngSubmit)="addGratitudeEntry()">
        <div class="form-container">

          <div class="form-group">
            <label>ğŸ“… Datum</label>
            <input type="date" formControlName="date" />
          </div>

          <div class="form-group">
            <label>ğŸ’­ Za Å¡ta si zahvalan/na danas?</label>

            <div class="items-list">
              <div
                *ngFor="let item of items.controls; let i = index"
                class="item-input-group"
              >
                <input
                  type="text"
                  [formControl]="$any(item)"
                  [placeholder]="'Stavka ' + (i + 1)"
                  class="item-input"
                />
                <button
                  type="button"
                  class="btn-remove-item"
                  (click)="removeItem(i)"
                  *ngIf="items.length > 1"
                >
                  âœ•
                </button>
              </div>
            </div>

            <button
              type="button"
              class="btn-add-item"
              (click)="addItem()"
              *ngIf="items.length < 10"
            >
              â• Dodaj joÅ¡ stavku
            </button>
          </div>

          <div class="form-group">
            <label>âœ¨ Highlight dana</label>
            <textarea
              formControlName="highlight"
              rows="3"
              placeholder="OpiÅ¡i najljepÅ¡i trenutak dana..."
            ></textarea>
          </div>

          <div class="form-group">
            <label>ğŸ˜Š Kako se osjeÄ‡aÅ¡?</label>
            <div class="mood-selector">
              <label class="mood-option" *ngFor="let m of ['amazing','good','okay','rough']">
                <input type="radio" formControlName="mood" [value]="m" />
                <span class="mood-emoji">{{ getMoodEmoji(m) }}</span>
                <span class="mood-label">{{ getMoodName(m) }}</span>
              </label>
            </div>
          </div>

          <button
            type="submit"
            class="btn-submit"
            [disabled]="gratitudeForm.invalid"
          >
            ğŸ’¾ SaÄuvaj zahvalnost
          </button>

        </div>
      </form>
    </div>


    <div class="loading" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>UÄitavanje...</p>
    </div>


    <div class="entries-container" *ngIf="!isLoading">

      <div class="empty-state" *ngIf="gratitudeEntries.length === 0">
        <div class="empty-icon">ğŸ™</div>
        <h2>Nema zapisa</h2>
        <p>ZapoÄni svoj gratitude journal!</p>
      </div>

      <div class="entries-masonry" *ngIf="gratitudeEntries.length > 0">
        <div *ngFor="let entry of gratitudeEntries" class="gratitude-card">

          <div class="card-header">
            <div class="card-date">
              <span class="date-text">{{ formatDate(entry.date) }}</span>
              <span class="mood-emoji-large">{{ getMoodEmoji(entry.mood) }}</span>
            </div>
            <button class="btn-delete" (click)="deleteGratitudeEntry(entry.id)">
              ğŸ—‘ï¸
            </button>
          </div>

          <div class="card-body">

            <div class="streak-badge" *ngIf="entry.streak > 1">
              ğŸ”¥ {{ entry.streak }} dana zaredom
            </div>

            <div class="gratitude-items">
              <h4>ğŸ’­ Zahvalan/na sam za:</h4>
              <ul>
                <li *ngFor="let item of entry.items">{{ item }}</li>
              </ul>
            </div>

            <div class="highlight-section">
              <h4>âœ¨ Highlight dana:</h4>
              <p>{{ entry.highlight }}</p>
            </div>

          </div>
        </div>
      </div>

    </div>

  </div>
</div>
